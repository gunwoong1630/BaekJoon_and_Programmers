SELECT MONTH(h1.START_DATE) AS MONTH,h1.CAR_ID,COUNT(*) AS RECORDS FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY h1
WHERE (SELECT COUNT(*) FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY h2
WHERE h2.START_DATE BETWEEN '2022-08-01' AND '2022-10-31' AND h1.CAR_ID = h2.CAR_ID) >= 5 AND h1.START_DATE BETWEEN '2022-08-01' AND '2022-10-31'
GROUP BY MONTH(h1.START_DATE),h1.CAR_ID
HAVING COUNT(*) !=0
ORDER BY MONTH(h1.START_DATE) ASC, h1.CAR_ID DESC